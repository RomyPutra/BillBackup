@model CustomDashboard
@{
	ViewData["Title"] = "Dashboard";
}
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
	
<div class=" container ">
	<!--begin::Dashboard-->
	<div class="row">
		<div class="col-xl-4">
			<!--begin::Mixed Widget 1-->
			<div class="card card-custom bg-gray-100 gutter-b card-stretch">
				<!--begin::Header-->
				<div class="card-header border-0 bg-danger py-5">
					<h3 class="card-title font-weight-bolder text-white">Statistik Singkat</h3>					
				</div>
				<!--end::Header-->

				<!--begin::Body-->
				<div class="card-body p-0 position-relative overflow-hidden">
					<!--begin::Chart-->
					<div class="card-rounded-bottom bg-danger" style="height: 70px"></div>
					<!--end::Chart-->

					<!--begin::Stats-->
					<div class="card-spacer mt-n25">
						<!--begin::Row-->
						<div class="row m-0">
							<div class="col bg-light-warning px-6 py-8 rounded-xl mr-7 mb-7">
								<span class="svg-icon svg-icon-3x svg-icon-warning d-block my-2"><!--begin::Svg Icon | path:/metronic/themes/metronic/theme/html/demo2/dist/assets/media/svg/icons/Media/Equalizer.svg-->
									<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24"/>
											<rect fill="#000000" opacity="0.3" x="13" y="4" width="3" height="16" rx="1.5"/>
											<rect fill="#000000" x="8" y="9" width="3" height="11" rx="1.5"/>
											<rect fill="#000000" x="18" y="11" width="3" height="9" rx="1.5"/>
											<rect fill="#000000" x="3" y="13" width="3" height="7" rx="1.5"/>
										</g>
									</svg><!--end::Svg Icon-->
								</span>                    
								<h2 class="text-warning font-weight-bold ">
									@Model.KotakEmpat.TotalUseSite / @Model.KotakEmpat.TotalSite
								</h2>
								<span class="text-warning font-weight-bold font-size-h6">
									Site Terpakai
								</span>
							</div>
							<div class="col bg-light-primary px-6 py-8 rounded-xl mb-7">
								<span class="svg-icon svg-icon-3x svg-icon-primary d-block my-2"><!--begin::Svg Icon | path:/metronic/themes/metronic/theme/html/demo2/dist/assets/media/svg/icons/Communication/Add-user.svg-->
									<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24"/>
											<path d="M5,19 L20,19 C20.5522847,19 21,19.4477153 21,20 C21,20.5522847 20.5522847,21 20,21 L4,21 C3.44771525,21 3,20.5522847 3,20 L3,4 C3,3.44771525 3.44771525,3 4,3 C4.55228475,3 5,3.44771525 5,4 L5,19 Z" fill="#000000" fill-rule="nonzero"/>
											<path d="M8.7295372,14.6839411 C8.35180695,15.0868534 7.71897114,15.1072675 7.31605887,14.7295372 C6.9131466,14.3518069 6.89273254,13.7189711 7.2704628,13.3160589 L11.0204628,9.31605887 C11.3857725,8.92639521 11.9928179,8.89260288 12.3991193,9.23931335 L15.358855,11.7649545 L19.2151172,6.88035571 C19.5573373,6.44687693 20.1861655,6.37289714 20.6196443,6.71511723 C21.0531231,7.05733733 21.1271029,7.68616551 20.7848828,8.11964429 L16.2848828,13.8196443 C15.9333973,14.2648593 15.2823707,14.3288915 14.8508807,13.9606866 L11.8268294,11.3801628 L8.7295372,14.6839411 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"/>
										</g>
									</svg><!--end::Svg Icon-->
								</span>                    
								<h4 class="text-primary font-weight-bold ">
									Rp @Model.KotakEmpat.Revenue / Rp @Model.KotakEmpat.TotalRevenue
								</h4>
								<span class="text-primary font-weight-bold font-size-h6">
									Pemasukan
								</span>
							</div>
						</div>
						<!--end::Row-->
						<!--begin::Row-->
						<div class="row m-0">
							<div class="col bg-light-danger px-6 py-8 rounded-xl mr-7">
								<span class="svg-icon svg-icon-3x svg-icon-danger d-block my-2"><!--begin::Svg Icon | path:/metronic/themes/metronic/theme/html/demo2/dist/assets/media/svg/icons/Design/Layers.svg-->
									<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<rect x="0" y="0" width="24" height="24"/>
											<path d="M2,6 L21,6 C21.5522847,6 22,6.44771525 22,7 L22,17 C22,17.5522847 21.5522847,18 21,18 L2,18 C1.44771525,18 1,17.5522847 1,17 L1,7 C1,6.44771525 1.44771525,6 2,6 Z M11.5,16 C13.709139,16 15.5,14.209139 15.5,12 C15.5,9.790861 13.709139,8 11.5,8 C9.290861,8 7.5,9.790861 7.5,12 C7.5,14.209139 9.290861,16 11.5,16 Z" fill="#000000" opacity="0.3" transform="translate(11.500000, 12.000000) rotate(-345.000000) translate(-11.500000, -12.000000) "/>
											<path d="M2,6 L21,6 C21.5522847,6 22,6.44771525 22,7 L22,17 C22,17.5522847 21.5522847,18 21,18 L2,18 C1.44771525,18 1,17.5522847 1,17 L1,7 C1,6.44771525 1.44771525,6 2,6 Z M11.5,16 C13.709139,16 15.5,14.209139 15.5,12 C15.5,9.790861 13.709139,8 11.5,8 C9.290861,8 7.5,9.790861 7.5,12 C7.5,14.209139 9.290861,16 11.5,16 Z M11.5,14 C12.6045695,14 13.5,13.1045695 13.5,12 C13.5,10.8954305 12.6045695,10 11.5,10 C10.3954305,10 9.5,10.8954305 9.5,12 C9.5,13.1045695 10.3954305,14 11.5,14 Z" fill="#000000"/>
										</g>
									</svg><!--end::Svg Icon-->
								</span>                    
								<h2 class="text-danger font-weight-bold ">
									@Model.KotakEmpat.TotalBooking order
								</h2>
								<span class="text-danger font-weight-bold font-size-h7">
									Jumlah Order Belum Terbayar
								</span>
							</div>
							<div class="col bg-light-success px-6 py-8 rounded-xl">
								<span class="svg-icon svg-icon-3x svg-icon-success d-block my-2"><!--begin::Svg Icon | path:/metronic/themes/metronic/theme/html/demo2/dist/assets/media/svg/icons/Communication/Urgent-mail.svg-->
									<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
										<g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
											<polygon points="0 0 24 0 24 24 0 24"></polygon>
											<path d="M18,14 C16.3431458,14 15,12.6568542 15,11 C15,9.34314575 16.3431458,8 18,8 C19.6568542,8 21,9.34314575 21,11 C21,12.6568542 19.6568542,14 18,14 Z M9,11 C6.790861,11 5,9.209139 5,7 C5,4.790861 6.790861,3 9,3 C11.209139,3 13,4.790861 13,7 C13,9.209139 11.209139,11 9,11 Z" fill="#000000" fill-rule="nonzero" opacity="0.3"></path>
											<path d="M17.6011961,15.0006174 C21.0077043,15.0378534 23.7891749,16.7601418 23.9984937,20.4 C24.0069246,20.5466056 23.9984937,21 23.4559499,21 L19.6,21 C19.6,18.7490654 18.8562935,16.6718327 17.6011961,15.0006174 Z M0.00065168429,20.1992055 C0.388258525,15.4265159 4.26191235,13 8.98334134,13 C13.7712164,13 17.7048837,15.2931929 17.9979143,20.2 C18.0095879,20.3954741 17.9979143,21 17.2466999,21 C13.541124,21 8.03472472,21 0.727502227,21 C0.476712155,21 -0.0204617505,20.45918 0.00065168429,20.1992055 Z" fill="#000000" fill-rule="nonzero"></path>
										</g>
									</svg><!--end::Svg Icon-->
								</span>                    
								<h2 class="text-success font-weight-bold ">
									@Model.KotakEmpat.TotalOrder /month
								</h2>
								<span class="text-success font-weight-bold font-size-h7">
									Jumlah Seluruh Transaksi
								</span>
							</div>
						</div>
						<!--end::Row-->
					</div>
					<!--end::Stats-->
				</div>
				<!--end::Body-->
			</div>
			<!--end::Mixed Widget 1-->
		</div>

		<div class="col-xl-8">
			<div class="card card-custom gutter-b">
				<div class="card-body">
					<div id="chartContainer" class="myautoscroll" style="height: 420px; width: 100%; padding:5px;margin:10px;"></div>
				</div>
			</div>
		</div>
	</div>

	<div class="row">
		<div class="col-xl-12">
			<!--begin::Tiles Widget 11-->
			<div class="card card-custom gutter-b">
				<div class="card-header">
					<div class="card-title">
						<h3 class="card-label">Daftar Transaksi</h3>
					</div>
				</div>

				<div class="card-body">
					<table class="table table-bordered table-hover table-checkable table-responsive" id="tdasboard" style="margin-top: 13px !important">
						<thead>
							<tr>
								<th>Nomor ID Transaksi</th>
								<th>Email Pembeli</th>
								<th>No Billboard</th>
								<th>Tanggal Pemesanan</th>
								<th>Tanggal Mulai Penayangan</th>
								<th>Tanggal Berakhir Penayangan</th>
								<th>Tanggal Transaksi</th>
								<th>Status Pemesanan</th>
								<th>Status Pembayaran</th>
								<th>Lama Penayangan (Hari)</th>
								<th>Jumlah Billboard</th>
								<th>Harga (Per Hari)</th>
								<th>Total Nilai Transaksi</th>
								@if (HttpContextAccessor.HttpContext.Session.GetString("_ROLE") != "SPV")
								{
									<th>Aktivasi</th>
								}
							</tr>
						</thead>
						<tbody>
							@{int i = 1;}
							@if (Model.PurchaseAndBook != null)
							{
								@foreach (var item in Model.PurchaseAndBook)
								{
									<tr>
										@*<td>@(i++)</td>*@
										<td>@Html.DisplayFor(modelItem => item.BookNo)</td>
										<td>@Html.DisplayFor(modelItem => item.UserName)</td>
										<td>@Html.DisplayFor(modelItem => item.NoBillBoard)</td>
										<td class="custom-date">@Html.DisplayFor(modelItem => item.TglBook)</td>
										<td class="custom-date">@Html.DisplayFor(modelItem => item.StartDate)</td>
										<td class="custom-date">@Html.DisplayFor(modelItem => item.EndDate)</td>
										<td class="custom-date">@Html.DisplayFor(modelItem => item.TglTrans)</td>
										<td>@Html.DisplayFor(modelItem => item.Status)</td>
										@if (item.Status.ToLower().Contains("progress"))
										{
											<td></td>
										}
										else if (item.TglTrans == null && item.Status.ToLower().Contains("approve"))
										{
											<td>Pending</td>
										}
										else if (item.TglTrans != null && item.Status.ToLower().Contains("approve"))
										{
											<td>Paid</td>
										}
										else
										{
											<td></td>
										}
										<td>@Html.DisplayFor(modelItem => item.Qty)</td>
										<td>@Html.DisplayFor(modelItem => item.Unit)</td>
										<td class="price">@Html.DisplayFor(modelItem => item.Harga)</td>
										<td class="price">@Html.DisplayFor(modelItem => item.HargaTotal)</td>
										@if (HttpContextAccessor.HttpContext.Session.GetString("_ROLE") != "SPV")
										{
											@if (item.Status.ToLower().Contains("progress"))
											{
												<td>
													<div class="btn-group">
														<button class="btn btn-success" onclick="btnapprove('1&@item.BookID|@item.BookNo&accept')">Accept</button>
														<button class="btn btn-danger" onclick="btnapprove('2&@item.BookID|@item.BookNo&declined')">Decline</button>
													</div>
												</td>
											}
											else
											{
												<td>
													<div class="btn-group">
														<button class="btn btn-success" disabled>Accept</button>
														<button class="btn btn-danger" disabled>Decline</button>
													</div>
												</td>
											}
											@*<td><a asp-controller="Site" asp-action="IndexPrice" asp-route-id="@item.NoBillBoard">View Price</a> | <a asp-controller="Site" asp-action="IndexImage" asp-route-id="@item.NoBillBoard">View Image</a></td>*@
										}
									</tr>
								}
							}
						</tbody>
					</table>
				</div>
			</div>
			<!--end::Tiles Widget 11-->
		</div>
	</div>

	<div class="row">
		<div class="col-xl-12">
			<!--begin::Tiles Widget 11-->
			<div class="card card-custom gutter-b">
				<div class="card-header">
					<div class="card-title">
						<h3 class="card-label">Laporan Permasalahan Site</h3>
					</div>
				</div>

				<div class="card-body table-responsive">
					<table id="tdasboard1" class="table table-bordered table-hover table-checkable" id="kt_datatable" style="margin-top: 13px !important">
						<thead>
							<tr>
								<th>No</th>
								<th>Report Number</th>
								<th>User Name</th>
								<th>No Billboard</th>
								<th>Masalah</th>
								@if (HttpContextAccessor.HttpContext.Session.GetString("_ROLE") != "SPV")
								{
									<th>Aksi</th>
								}
							</tr>
						</thead>
						<tbody>
							@{int x = 1;}
							@if (Model.PurchaseAndBook != null)
							{
								@foreach (var item in Model.SiteProblem)
								{
									<tr>
										<td>@(x++)</td>
										<td>@Html.DisplayFor(modelItem => item.ReportNo)</td>
										<td>@Html.DisplayFor(modelItem => item.From)</td>
										<td>@Html.DisplayFor(modelItem => item.NoBillboard)</td>
										<td>@Html.DisplayFor(modelItem => item.Desc)</td>
										@if (HttpContextAccessor.HttpContext.Session.GetString("_ROLE") != "SPV")
										{
											@*@if (item.Status.ToLower().Contains("progress"))
											{
												<td><button class="btn btn-primary" onclick="btnapprove('1&@item.BookID|@item.BookNo&accept')">Accept</button><button class="btn btn-danger" onclick="btnapprove('2&@item.BookID|@item.BookNo&declined')">Decline</button></td>
											}
											else
											{
												<td><button class="btn btn-primary" disabled>Accept</button><button class="btn btn-danger" disabled>Decline</button></td>
											}*@
											<td><button class="btn btn-success" disabled>Accept</button><button class="btn btn-danger" disabled>Decline</button></td>
										}
									</tr>
								}
							}
						</tbody>
					</table>
				</div>
			</div>
			<!--end::Tiles Widget 11-->
		</div>
	</div>
</div>